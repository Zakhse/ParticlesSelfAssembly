webpackJsonp([1],{NHnr:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("7+uW"),n=i("M4fF"),s=i.n(n),l=i("zL8q"),r=i.n(l),o=i("wUZ8"),c=i.n(o),u=i("BO1k"),v=i.n(u),h=i("//Fk"),f=i.n(h),d=i("GpYf"),g=i.n(d),p=i("okF9"),m=i("q/VF"),C=i.n(m),y={EMPTY:1,HORIZONTAL:2,VERTICAL:3};function b(t){return{reason:t}}var w={something_is_wrong:"Что-то пошло не так",file_is_not_text:"Требуется текстовый файл",line_length_mismatch_size:"Одна из строк файла не соответствует размеру",line_number_mismatch_size:"Количество строк файла не соответствует размеру",already_uploaded:"Этот файл уже выбран"},k="showErrorToast",B="Неизвестная ошибка";function D(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=e.defaultMsg,a=e.customDict,n=e.onlyCustomDict;return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=e.defaultMsg,a=void 0===i?B:i,n=e.customDict,s=e.onlyCustomDict,l=void 0;return n&&(l=n[t]),n&&l||s||(l=w[t]),l||a}(t.reason,{defaultMsg:i,customDict:a,onlyCustomDict:n})}function N(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=i.defaultMsg,n=i.reject,s=void 0===n||n,l=i.onlyCustom,r=void 0!==l&&l,o=i.customDict;if(r&&!o)throw new SyntaxError("If 'onlyCustom' property is used, pass 'customDict' also!");return function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=i.defaultMsg,n=i.customDict,s=i.onlyCustomDict;t(k,D(e,{defaultMsg:a,customDict:n,onlyCustomDict:s}))}(t,e,{defaultMsg:a,customDict:o,onlyCustomDict:r}),s?f.a.reject(e):f.a.resolve(e)}var F=i("gRE1"),R=i.n(F),E=.9;function T(t,e){var i=t[e];if(e===i)return e;var a=T(t,i);return t[e]!==a&&(t[e]=a),a}function A(t,e,i,a,n,s,l,r,o){if(l[e][t]!==y.EMPTY){var c=null===i&&null===a,u=null===n&&null===s,v=0,h=l[e][t];if(c||l[a][i]!==h||(v+=1),u||l[s][n]!==h||(v+=2),0===v){var f=o.length;r[e][t]=f,o.push(f)}else if(1===v)r[e][t]=r[a][i];else if(2===v)r[e][t]=r[s][n];else{if(3!==v)throw new Error("Strange state of mask: "+v);var d=T(o,r[s][n]),g=T(o,r[a][i]);d<g?(r[e][t]=d,o[g]=d):(r[e][t]=g,o[d]=g)}}}function x(t,e,i,a,n,s,l,r,o){if(l[e][t]!==y.EMPTY){var c=T(o,r[e][t]);A(t,e,i,a,n,s,l,r,o);var u=T(o,r[e][t]);u!==c&&(u>c?o[u]=c:o[c]=u)}}function O(t){for(var e=function(t){if(!Array.isArray(t))throw new Error("Provided argument is not array");if(t.length<2||t[0].length<2)throw new Error("Provided array is too small");for(var e=t.length-1,i=t[0].length-1,a=t.length,n=[],s=Array(a),l=0;l<a;l++)s[l]=Array(a);A(0,0,null,null,null,null,t,s,n);for(var r=1;r<a;r++)A(r,0,r-1,0,null,null,t,s,n);for(var o=1;o<a;o++)A(0,o,null,null,0,o-1,t,s,n);for(var c=1;c<a;c++)for(var u=1;u<a;u++)A(u,c,u-1,c,u,c-1,t,s,n);x(0,0,i,0,0,e,t,s,n);for(var v=1;v<=i;v++)x(v,0,v-1,0,v,e,t,s,n);for(var h=1;h<=e;h++)x(0,h,i,h,0,h-1,t,s,n);for(var f=void 0,d=0;d<a;d++)for(var g=0;g<a;g++)void 0!==(f=s[d][g])&&(s[d][g]=T(n,f));return s}(t),i={horizontal:{},vertical:{}},a=t.length,n=t[0].length,s=void 0,l=void 0,r=void 0,o=0;o<a;o++)for(var c=0;c<n;c++)(s=t[o][c])!==y.EMPTY&&(l=e[o][c],void 0!==i[r=s===y.HORIZONTAL?"horizontal":"vertical"][l]?i[r][l]+=1:i[r][l]=1);return i}var M=function(t){return new f.a(function(e,i){var a,n,s,l,r,o=void 0;try{a=O(t),n=0,s=0,l=0,r=0,R()(a.vertical).forEach(function(t){r+=t,t>l&&(l=t)}),R()(a.horizontal).forEach(function(t){s+=t,t>n&&(n=t)}),o=n/s>=E&&l/r>=E}catch(t){}o?e():i()})},z=.1;var S=function(t){return new f.a(function(e,i){var a=void 0;try{a=function(t,e){var i=t.length-1,a=t[0].length-1,n=0,s=0,l=0,r=void 0,o=void 0;function c(e,i,a,c,u,v){(r=t[i][e])!==y.EMPTY&&(r===y.HORIZONTAL?(o=y.VERTICAL,n++):(o=y.HORIZONTAL,s++),t[v][u]===o&&l++,t[c][a]===o&&l++)}for(var u=0;u<i;u++)for(var v=0;v<a;v++)c(v,u,v+1,u,v,u+1);for(var h=i,f=0;f<a;f++)c(f,h,f+1,h,f,0);for(var d=a,g=0;g<i;g++)c(d,g,0,g,d,g+1);return c(a,i,0,i,a,0),l/((n+s)/e)<z}(t,8)}catch(t){}a?e():i()})},I=i("H52G"),L=i.n(I),P={name:"LatticeFileComponent",props:{file:{type:File,required:!0}},data:function(){return{canvas:null,canvasContext:null,bigCanvasDialogVisible:!1,bigCanvasWasDrawn:!1,parsedData:[],parsingFile:!1,checkingByClasters:!1,checkingByNeighbours:!1,checkByClastersResult:null,checkByNeighboursResult:null}},computed:{fileSize:function(){return L()(this.file.size)},size:function(){return this.parsedData.length},canvasNonScaled:function(){var t=this.size,e=document.createElement("canvas");e.width=1*t,e.height=1*t;for(var i=e.getContext("2d"),a=this.parsedData,n=0;n<t;n++)for(var s=0;s<t;s++){switch(a[s][n]){case y.VERTICAL:i.fillStyle="red";break;case y.HORIZONTAL:i.fillStyle="blue";break;case y.EMPTY:default:i.fillStyle="white"}i.fillRect(1*n,1*s,1,1)}return e}},methods:{checkByClasters:function(){var t=this;this.checkingByClasters=!0,M(this.parsedData).then(function(){t.checkByClastersResult="yes",t.checkingByClasters=!1}).catch(function(){t.checkByClastersResult="no",t.checkingByClasters=!1})},checkByNeighbours:function(){var t=this;this.checkingByNeighbours=!0,S(this.parsedData).then(function(){t.checkByNeighboursResult="yes",t.checkingByNeighbours=!1}).catch(function(){t.checkByNeighboursResult="no",t.checkingByNeighbours=!1})},fillCanvas:function(){this.canvasContext&&this.canvasContext.drawImage(this.canvasNonScaled,0,0,this.canvas.width,this.canvas.height)},fillBigCanvas:function(){if(!this.bigCanvasWasDrawn){var t=this.$refs.bigCanvas;if(t){var e=t.getContext("2d");e&&(e.imageSmoothingEnabled=!1,e.drawImage(this.canvasNonScaled,0,0,t.width,t.height),this.bigCanvasWasDrawn=!0)}}},openBigCanvasDialog:function(){this.bigCanvasDialogVisible=!0},bigCanvasDialogOpened:function(){var t=this;this.$nextTick(function(){t.fillBigCanvas()})},parseFile:function(){var t=this;return this.parsingFile=!0,function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=i.empty,n=void 0===a?"1":a,s=i.vertical,l=void 0===s?"3":s,r=i.horizontal,o=void 0===r?"2":r,c=new C.a(t);return new f.a(function(t,i){var a=[];c.readSomeLines(0,function s(r,u,h,f){r&&i(b("something_is_wrong"));var d=!0,g=!1,p=void 0;try{for(var m,C=v()(h);!(d=(m=C.next()).done);d=!0){var _=m.value,w=[],k=!0,B=!1,D=void 0;try{for(var N,F=v()(_);!(k=(N=F.next()).done);k=!0)switch(N.value){case n:w.push(y.EMPTY);break;case l:w.push(y.VERTICAL);break;case o:w.push(y.HORIZONTAL)}}catch(r){B=!0,D=r}finally{try{!k&&F.return&&F.return()}finally{if(B)throw D}}if(w.length!==e)return void i(b("line_length_mismatch_size"));a.push(w)}}catch(r){g=!0,p=r}finally{try{!d&&C.return&&C.return()}finally{if(g)throw p}}if(f)a.length!==e?i(b("line_number_mismatch_size")):t(a);else{var R=u+h.length;R>=e?i(b("line_number_mismatch_size")):c.readSomeLines(R,s)}})})}(this.file,256).then(function(e){t.parsingFile=!1,t.parsedData=e}).catch(function(e){return t.parsingFile=!1,t.$emit("remove"),N(t.$store.dispatch,e,{reject:!1})})}},mounted:function(){this.canvas=this.$refs.cnv,this.canvasContext=this.canvas.getContext("2d"),this.canvasContext.imageSmoothingEnabled=!1,this.fillCanvas()},watch:{canvasNonScaled:{handler:function(){this.fillCanvas(),this.bigCanvasWasDrawn=!1,this.fillBigCanvas()},immediate:!0},file:{handler:function(){this.parseFile()},immediate:!0}}},V={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"lattice-file-root"},[i("div",{staticClass:"lattice-file-info-container",on:{click:t.openBigCanvasDialog}},[i("div",{directives:[{name:"loading",rawName:"v-loading",value:t.parsingFile,expression:"parsingFile"}]},[i("canvas",{ref:"cnv",staticClass:"info-canvas",attrs:{width:"128",height:"128"}})]),t._v(" "),i("div",{staticClass:"right-part"},[i("div",{staticClass:"file-info-and-close"},[i("div",{staticClass:"filename"},[t._v("\n                    "+t._s(t.file.name)+"\n                ")]),t._v(" "),i("div",{staticClass:"filesize"},[t._v("\n                    "+t._s(t.fileSize)+"\n                ")]),t._v(" "),i("el-button",{staticClass:"close-button",attrs:{type:"text",icon:"el-icon-close"},on:{click:function(e){t.$emit("remove")}}})],1),t._v(" "),t.parsingFile?t._e():i("div",{staticClass:"check-row"},[i("div",{staticClass:"check-by-clasters-block"},[i("div",{staticClass:"method-label"},[t._v("\n                        Метод кластеров\n                    ")]),t._v(" "),null===t.checkByClastersResult?i("el-button",{attrs:{loading:t.checkingByClasters},on:{click:function(e){e.stopPropagation(),t.checkByClasters(e)}}},[t._v("\n                        Проверить\n                    ")]):t._e(),t._v(" "),"yes"===t.checkByClastersResult?i("div",{staticClass:"result success"},[i("i",{staticClass:"el-icon-check"})]):t._e(),t._v(" "),"no"===t.checkByClastersResult?i("div",{staticClass:"result failed"},[i("i",{staticClass:"el-icon-close"})]):t._e()],1),t._v(" "),i("div",{staticClass:"check-by-neighbours-block"},[i("div",{staticClass:"method-label"},[t._v("\n                        Метод соседей\n                    ")]),t._v(" "),null===t.checkByNeighboursResult?i("el-button",{attrs:{loading:t.checkingByNeighbours},on:{click:function(e){e.stopPropagation(),t.checkByNeighbours(e)}}},[t._v("\n                        Проверить\n                    ")]):t._e(),t._v(" "),"yes"===t.checkByNeighboursResult?i("div",{staticClass:"result success"},[i("i",{staticClass:"el-icon-check"})]):t._e(),t._v(" "),"no"===t.checkByNeighboursResult?i("div",{staticClass:"result failed"},[i("i",{staticClass:"el-icon-close"})]):t._e()],1)])])]),t._v(" "),i("el-dialog",{staticClass:"scaled-view-dialog",attrs:{"show-close":!1,visible:t.bigCanvasDialogVisible},on:{open:t.bigCanvasDialogOpened,"update:visible":function(e){t.bigCanvasDialogVisible=e}}},[i("canvas",{ref:"bigCanvas",staticClass:"big-canvas",attrs:{width:"512",height:"512"}})])],1)},staticRenderFns:[]};var Y={name:"App",data:function(){return{addedFiles:[]}},methods:{handleUpload:function(t){var e,i,a=this,n=t.file;_.some(this.addedFiles,function(t){return t.name===n.name})?N(this.$store.dispatch,{reason:"already_uploaded"},{reject:!1}):(e=n,i=e.slice(0,4100),Object(p.readAsArrayBuffer)(i).then(function(t){return g()(t)?f.a.reject(b("file_is_not_text")):null})).then(function(){a.addedFiles.push(n)})},removeAddedFile:function(t){this.addedFiles.splice(t,1)}},components:{Lattice:i("VU/8")(P,V,!1,function(t){i("ufIw"),i("WKMG")},"data-v-547a255d",null).exports}},H={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"app"}},[i("el-upload",{staticClass:"files-upload",attrs:{multiple:"",action:"","show-file-list":!1,"http-request":t.handleUpload}},[i("el-button",{attrs:{size:"small",type:"primary"}},[t._v("Выбрать файлы\n        ")]),t._v(" "),i("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("файлы с данными квадратной решётки\n        ")])],1),t._v(" "),i("div",{staticClass:"lattice-files-list"},[t.addedFiles.length?t._e():i("div",{staticClass:"no-files"},[t._v("\n            Выберите файлы с данными\n        ")]),t._v(" "),t._l(t.addedFiles,function(e,a){return i("lattice",{key:e.uid,staticClass:"lattice-file",attrs:{file:e},on:{remove:function(e){t.removeAddedFile(a)}}})})],2)],1)},staticRenderFns:[]};var $=i("VU/8")(Y,H,!1,function(t){i("YFfw"),i("gmpQ")},"data-v-a993b25a",null).exports,j=i("NYxO");a.default.use(j.a);var W=new j.a.Store({state:{},getters:{},mutations:{},actions:{showToast:function(t,e){var i=e.type,a=e.message,n=e.title;Object(l.Notification)({title:n,message:a,type:i})},showSuccessToast:function(t,e){t.dispatch("showToast",{message:e,type:"success"})},showErrorToast:function(t,e){t.dispatch("showToast",{message:e,type:"error"})}}});a.default.config.productionTip=!1,a.default.use(r.a,{locale:c.a}),window._=s.a,new a.default({el:"#app",store:W,template:"<App/>",components:{App:$}})},WKMG:function(t,e){},YFfw:function(t,e){},gmpQ:function(t,e){},ufIw:function(t,e){}},["NHnr"]);